# TODO

- alter star: allow a rule in front which can be matched without requiring the rest to be matched
  - currently, if _anything_ matched under a star, a subsequent error under the same star will be an error
  - however, I'd like to allow some _subset_ of the sequence to match, and _only then_ will subsequent errors lift out of the star
- [ ] test parser: autotab
  - [ ] define the grammar
    - [ ] Peg `$`
    - [ ] Peg `->`
    - [ ] Peg `{,}`
  - [ ] compile texprs into a high-level grammar
  - [ ] compiler from a high-level PEG grammar to the core, low-level PEG grammar (`Text.Texpr.Tree`)
  - [ ] test if autotab.tbnf correctly detects tables
- [ ] parser for a language defining PEGs
  - [x] should be literate by default
  - [x] define character sets
  - [ ] define rules
    - [x] define string, char
    - [x] define Sat
    - [x] define Call/Replay
    - [x] define repetition
    - [x] define alternation
    - [ ] define Not; takes a message and a rule, fails with message when rule matches
    - [ ] fix Void so it always fails
    - [x] define grouping, flatten
    - [ ] define Expect
    - [ ] define Capture
    - [ ] define Recover
- cleanup:
  - [ ] import control
  - [ ] documentation
  - [ ] newtypes for restricted strings
  - [x] better position type
  - [x] ErrorReport should be a record
  - [x] Texpr.Error (and ErrorReport) should carry a "reason", which is just the expected set + position
- [ ] Texpr (sequence) rewriter based on simple pattern-matching
  - [ ] the match/rewrite algorithm
  - [ ] define a textual grammar for rewriters
- [?] when erroring, collect a context along with the input so that parsing can be resumed
- interfaces:
  - [ ] represent grammars (high- and low-level) as json